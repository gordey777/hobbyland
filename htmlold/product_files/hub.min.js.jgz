var Netotiate=Netotiate||{};Netotiate.nq=Netotiate.$=function(){var a=this;return a=function(b){var c={};switch(typeof b){case"string":c.dom=document.querySelectorAll(b);break;case"object":c.dom=[b];break;default:c.dom={}}return c.nquery="1",c.eq=function(b){return this.length()>b?a(this.dom[b]):void 0},c.length=function(){return this.dom.length||0},c.find=function(a){if(this.length()>0){try{return c.dom=this.dom[0].querySelectorAll(a),c}catch(b){}return c}return c},c.hide=function(a){if(this.length())for(var b=0;b<this.dom.length;b++)this.dom[b].style.display="none","function"==typeof a&&a(this.dom[b])},c.show=function(a){if(this.length())for(var b=0;b<this.dom.length;b++)this.dom[b].style.display="","function"==typeof a&&a(this.dom[b])},c.fadeOut=function(a){var b=1,c=2,d=function(d){var e=d.style,f=isNaN(parseFloat(e.opacity))?1:parseFloat(e.opacity);f=100*f,e.display="block",function g(){f-=c,e.opacity=f/100,f>0?setTimeout(g,b):(e.display="none","function"==typeof a&&a())}()};if(this.length())for(var e=0;e<this.dom.length;e++)d(this.dom[e])},c.fadeIn=function(a){var b=1,c=2,d=function(d,e){var f=d.style,g=0;f.opacity=0,f.display="block",function h(){g+=c,f.opacity=g/100,100*e>g?setTimeout(h,b):"function"==typeof a&&a()}()};if(this.length())for(var e=0;e<this.dom.length;e++){var f=""==this.dom[e].style.opacity||0==this.dom[e].style.opacity?1:this.dom[e].style.opacity;d(this.dom[e],f)}},c.slideDown=function(b,c){var d=function(d){var e=a(d).getCss("height"),f=e.replace("px",""),g=parseInt(a(d).getCss("height").replace("px","")),h=0,i=1,j=1;b&&(j=b/g),d.style.display="inline-block",d.style.height="0px";var k=function(){return h+=i,d.style.height=h+"px",g>h?setTimeout(function(){k()},j):(d.style.height=f+"px","function"==typeof c&&c(d),!1)};k()};if(this.length())for(var e=0;e<this.dom.length;e++)d(this.dom[e])},c.slideUp=function(b,c){var d=function(d){var e=a(d).getCss("height"),f=e,g=parseInt(a(d).getCss("height").replace("px","")),h=1,i=1;b&&(i=b/g),d.style.height=e;var j=function(){return g-=h,d.style.height=g+"px",g>0?setTimeout(function(){j()},i):(d.style.display="none",d.style.height=f,"function"==typeof c&&c(),!1)};j()};if(this.length())for(var e=0;e<this.dom.length;e++)d(this.dom[e])},c.animate_callback=function(){return!1},c.speedEvent=!1,c.speed=function(){return this.speedEvent=!0,c},c.animate=function(b,c,d){var e=function(a){return isNaN(parseFloat(a))?0:parseFloat(a)},f=this;if("function"==typeof d&&(this.animate_callback=d),a.animation_running)return!1;a.animation_running=!0,a.animation_queue_counter=a.count(b)*this.length();var g=10;f._animate=function(b,c,d,f){var h=this,i=e(a(b).getCss(c));if("string"==typeof d&&(d=1*d.replace("px","")),Math.round(i)==Math.round(d)||Math.floor(i)==Math.floor(d))return a.animate_dequeue(h),!1;this.speedEvent;var j=Math.abs(d-i);f>j&&(f=j);var k={},l=d>=i?1:-1;return i+=l*f,k[c]=i+"px",a(b).setCss(k),setTimeout(function(){h._animate(b,c,d,f)},g)},f.each(function(d,h){a.each(b,function(b,d){var i=50;if(c){var j=e(a(h).getCss(b)),k="string"==typeof d?1*d.replace("px",""):d;i=Math.abs(j-k)/(c/g)}f._animate(h,b,d,i)})})},c.scrollTo=function(a,b){if(!(0>b)){var d=10,e=c.dom[0],f=e.scrollTop,g=a-f,h=g/(b/d),i=function(a,b){if(!(e.scrollTop>=a)){var c=e.scrollTop;e.scrollTop+=b,e.scrollTop!=c&&setTimeout(function(){i(a,b)},d)}};i(a,h)}},c.html=function(a){if(!a)return el.innerHTML;for(var b=function(b){b.innerHTML=a},d=0;d<this.length();d++)b(this.dom[d]);return c},c.each=function(a){for(var b=0;b<this.length()&&"break"!=a(b,c.dom[b]);b++);},c.removeClass=function(b){var c=function(c){if(b){var d=c.className.split(" "),e=Array();class_name_array=b.split(",");for(var f=0;f<d.length;f++){for(var g=!1,h=0;h<class_name_array.length;h++)class_name_array[h]==d[f]&&(g=!0);g||e.push(d[f])}c.className=a.trim(e.join(" "))}else c.className=""};if(this.length())for(var d=0;d<this.dom.length;d++)c(this.dom[d])},c.addClass=function(b){var c=function(c){classNameArray=c.className.split(" "),class_name_array=b.split(",");for(var d=0;d<class_name_array.length;d++)classNameArray.push(class_name_array[d]);c.className=a.trim(classNameArray.join(" "))};if(this.length())for(var d=0;d<this.dom.length;d++)c(this.dom[d])},c.hasClass=function(a){var b=function(b){for(var c=b.className.split(" "),d=0;d<c.length;d++)if(c[d]==a)return!0;return!1};return this.length()?b(this.dom[0]):!1},c.getCss=function(b){return this.length()&&(el=this.dom[0]),void 0!=a.styles(el)[b]?a.styles(el)[b]:void 0!=el[b]?el[b]+"":""},c.setCss=function(a){var b=function(b){for(var c in a)try{b.style[c]=a[c]}catch(d){console.log(d)}};if(this.length())for(var d=0;d<this.dom.length;d++)b(this.dom[d]);return c},c.offset=function(){if(0!=this.length()){var a=c.dom[0],b=ot=0;if(a.offsetParent)do b+=a.offsetLeft,ot+=a.offsetTop;while(a=a.offsetParent);return{left:b,top:ot}}},c.width=function(){return this.length()?(el=this.dom[0],el==document?Math.max(el.body.scrollWidth,el.documentElement.scrollWidth,el.body.offsetWidth,el.documentElement.offsetWidth,el.body.clientWidth,el.documentElement.clientWidth):el.offsetWidth):""},c.height=function(){return this.length()?(el=this.dom[0],el==document?Math.max(el.body.scrollHeight,el.documentElement.scrollHeight,el.body.offsetHeight,el.documentElement.offsetHeight,el.body.clientHeight,el.documentElement.clientHeight):el.offsetHeight):""},c.scrollTop=function(a){return this.length()?(a&&(this.dom[0].scrollTop=a),this.dom[0].scrollTop):""},c.scrollLeft=function(a){return this.length()?(a&&(this.dom[0].scrollLeft=a),this.dom[0].scrollLeft):""},c.getAttr=function(a){return this.length()?(el=this.dom[0],el.getAttribute(a)):""},c.setAttr=function(a,b){var d=function(c){c.setAttribute(a,b)};if(this.length())for(var e=0;e<this.dom.length;e++)d(this.dom[e]);return c},c.is=function(a){var b=function(){return!1};switch(a){case":visible":b=function(a){"hidden"==a.style.visibility||"none"==a.style.display};break;default:return!1}return this.length()?(el=this.dom[0],b(el)):!1},c.getRaw=function(){return this.length()?this.dom[0]:{}},c.parent=function(){return this.length()?a(this.dom[0].parentNode):{}},c.append=function(b){return b.nquery&&(b=b.getRaw()),this.length()&&this.dom[0].appendChild(b),a(b)},c.appendTo=function(b){return b.nquery||(b=a(b)),b.append(this)},c.remove=function(){var a=function(a){document.body.removeChild(a)};this.each(function(b,c){a(c)}),c.dom=[]},c.replaceWith=function(a){a.nquery&&(a=a.getRaw()),this.length()&&this.dom[0].parentNode&&this.dom[0].parentNode.replaceChild(a,this.dom[0])},c.after=function(b){if(this.length()){var c=this.dom[0].nextElementSibling;return this.dom[0].parentNode.insertBefore(b,c),a(b)}},c.next=function(b){if(this.length()){var c=this.dom[0],d=a(c.nextElementSibling);if(b){var e=!1,f=a(b);return f.each(function(a,b){return b.previousElementSibling===c?(e=!0,"break"):void 0}),e?d:{}}return d}return{}},c.position=function(){return this.length()?(el=this.dom[0],{top:el.offsetTop,left:el.offsetLeft}):{top:null,left:null}},c.bind=function(b,d){var e=function(c){"object"!=typeof c._nq_events&&(c._nq_events={}),"object"!=typeof c._nq_events[b]&&(c._nq_events[b]=[]);var e=function(b){var c=[b];"object"==typeof b.detail&&(c=a.extend([b],b.detail)),d.apply(this,c)};c.addEventListener?c.addEventListener(b,e,!1):c.attachEvent("on"+b,e);var f=function(a,b){d(a,b)};c._nq_events[b].push({o:e,f:f})};if(this.length())for(var f=0;f<this.dom.length;f++)e(this.dom[f]);return c},c.trigger=function(a,b){var c=function(c){for(var d=0;d<c._nq_events[a].length;d++){var e=c._nq_events[a][d];e.f(c,b)}},d=function(d){if("object"!=typeof d._nq_events)return!1;if("object"!=typeof d._nq_events[a])return!1;var e,f=!1;if(b){if(window.CustomEvent&&"function"==typeof CustomEvent)e=new CustomEvent(a,{detail:b});else if(document.createEvent)e=document.createEvent("CustomEvent"),e.initCustomEvent(a,!0,!0,b);else if(document.createEventObject)try{var e=document.createEventObject();d.fireEvent("on"+a,e),f=!0}catch(g){c(d),f=!0}f||(d.dispatchEvent?d.dispatchEvent(e):window.dispatchEvent(e))}else if(document.createEvent)e=document.createEvent("HTMLEvents"),e.initEvent(a,!0,!1),d.dispatchEvent?d.dispatchEvent(e):window.dispatchEvent(e);else if(document.createEventObject)try{var h=document.createEventObject();d.fireEvent("on"+a,h),f=!0}catch(g){c(d)}};if(this.length())for(var e=0;e<this.dom.length;e++)d(this.dom[e])},c.unbind=function(a){var b=function(b){if("object"!=typeof b._nq_events)return!1;if("object"!=typeof b._nq_events[a])return!1;for(var c=0;c<b._nq_events[a].length;c++){var d=b._nq_events[a][c].o;b.removeEventListener?b.removeEventListener(a,d):b.detachEvent&&b.detachEvent("on"+a,d)}b._nq_events[a]=[]};if(this.length())for(var d=0;d<this.dom.length;d++)b(this.dom[d]);return c},c.bind=function(b,d){var e=function(c){"object"!=typeof c._nq_events&&(c._nq_events=[]);var e="func_"+a.getKeys(c._nq_events).length,f=function(b){var c=[b];"object"==typeof b.detail&&(c=a.extend([b],b.detail)),d.apply(this,c)},g=function(e){var f=[e];f=a.extend([e],c[b+"_detail"]),d.apply(this,f)};c[b]=0,c._nq_events[e]=f,c.addEventListener?c.addEventListener(b,f,!1):(c.attachEvent("on"+b,f),c.attachEvent("onpropertychange",function(a){a.propertyName==b&&g(a)}))};if(this.length())for(var f=0;f<this.dom.length;f++)e(this.dom[f]);return c},c.trigger=function(a,b){var d=function(c){c[a+"_detail"]={};try{if(b){if(window.CustomEvent){if("function"==typeof CustomEvent){var d=new CustomEvent(a,{detail:b});c.dispatchEvent?c.dispatchEvent(d):window.dispatchEvent(d)}else if(document.createEvent){var d=document.createEvent("CustomEvent");d.initCustomEvent(a,!0,!0,b),c.dispatchEvent?c.dispatchEvent(d):window.dispatchEvent(d)}else if(document.createEventObject)try{var e=document.createEventObject();c.fireEvent("on"+a,e)}catch(f){c[a+"_detail"]=b,c[a]++}}else if(document.createEvent){var d=document.createEvent("CustomEvent");d.initCustomEvent(a,!0,!0,b),c.dispatchEvent?c.dispatchEvent(d):window.dispatchEvent(d)}else if(document.createEventObject)try{var e=document.createEventObject();c.fireEvent("on"+a,e)}catch(f){c[a+"_detail"]=b,c[a]++}}else if(document.createEvent){var d=document.createEvent("HTMLEvents");d.initEvent(a,!0,!1),c.dispatchEvent?c.dispatchEvent(d):window.dispatchEvent(d)}else if(document.createEventObject)try{var e=document.createEventObject();c.fireEvent("on"+a,e)}catch(f){c[a+"_detail"]=b,c[a]++}}catch(f){console.log(f)}};if(this.length())for(var e=0;e<this.dom.length;e++)d(this.dom[e]);return c},c.unbind=function(a,b){var d=function(c){if("object"!=typeof c._nq_events)return!1;if(b)return c.removeEventListener?c.removeEventListener(a,b):c.detachEvent&&c.detachEvent("on"+a,b),!0;for(func_name in c._nq_events)c._nq_events.hasOwnProperty(func_name)&&(c.removeEventListener?c.removeEventListener(a,c._nq_events[func_name]):c.detachEvent&&c.detachEvent("on"+a,c._nq_events[func_name]))};if(this.length())for(var e=0;e<this.dom.length;e++)d(this.dom[e]);return c},c.loadData=function(b,d){return a.ajax({url:b,cache:!1,contentType:"text/plain",dataType:"html",success:function(a){c.html(a),"function"==typeof d&&d()}}),c},c.load=function(a){var b=function(b){b.addEventListener?b.addEventListener("load",a,!1):b.attachEvent("onload",a)};if(this.length())for(var d=0;d<this.dom.length;d++)b(this.dom[d]);return c},c.ready=function(b){a.readyAdd(b)},c},a.bindOnFinish=function(b,c){var d=function(a,b){var c;return function(){c&&clearTimeout(c),c=setTimeout(b,a)}},e=d(200,function(){a(window).trigger(b+"_end")});a(window).bind(b+"_end",c),a(window).bind(b,e)},a.unbindOnFinishEvent=function(a){Netotiate.nq(window).unbind(a)},a.create=function(b){return a(document.createElement(b))},a.count=function(a){var b=0;for(var c in a)a.hasOwnProperty(c)&&++b;return b},a.each=function(a,b){if("object"==typeof a)for(var c in a)a.hasOwnProperty(c)&&void 0!=c&&b(c,a[c])},a.inArray=function(a,b){for(var c=0;c<a.length;c++)if(a[c]==b)return!0;return!1},a.grep=function(a,b){for(var c=new Array,d=0;d<a.length;d++){var e=a[d];b(e,d)&&c.push(e)}return c},a.extend=function(b,c,d){if(d&&("boolean"==typeof b||1==b||0==b?(b=c,c=d):(b=a.extend(b,c),c=d)),a.isArray(b)&&a.isArray(c)){for(var e=0;e<c.length;e++){for(var f=!1,g=0;g<b.length;g++)b[g]==c[e]&&(f=!0);f||b.push(c[e])}return b}var h={};for(var i in b)h[i]=b[i];for(var i in c)h[i]=c[i];return b=h},a.isArray=function(a){return a.push?!0:!1},a.styles=function(a){if(void 0==a.ownerDocument)return{};var b,c,d=a.ownerDocument.defaultView?a.ownerDocument.defaultView.getComputedStyle(a,null):a.currentStyle,e={};if(d&&d.length&&d[0]&&d[d[0]])for(c=d.length;c--;)b=d[c],"string"==typeof d[b]&&(e[b]=d[b]);else for(b in d)"string"==typeof d[b]&&(e[b]=d[b]);return e},a.support={cors:!0},a.fn={},a.ajax=function(b){var c=!1,d={type:"GET",url:"",data:"",timeout:0,async:!0,contentType:"application/json; charset=utf-8",success:function(){return!1},error:function(){return!1}};for(var e in b)e in b&&(d[e]=b[e]);var f=new XMLHttpRequest;f.open(d.type,d.url,!0),f.setRequestHeader("Content-Type",d.contentType),d.dataType=a.trim(d.dataType||"*");var g={xml:"application/xml,text/xml",html:"text/html",text:"text/plain",json:"application/json,text/javascript","*":"*/*",script:"text/javascript,application/javascript,application/ecmascript,application/x-ecmascript"};allTypes=["*/"]+["*"],f.setRequestHeader("Accept",d.dataType&&g[d.dataType]?g[d.dataType]+("*"!==d.dataType?", "+allTypes+"; q=0.01":""):g["*"]);var h=function(a){if(d.contentType.indexOf("json")>-1){try{var b=window.JSON.parse(a)}catch(c){b=""}return b}return d.contentType.indexOf("xml")>-1?a:a};return f.onreadystatechange=function(){4==f.readyState&&(200==f.status?c?d.error():d.success(h(f.responseText)):d.error())},d.timeout>0&&(b.timeout=1e3*b.timeout,setTimeout(function(){f.readyState<4&&(c=!0),b.success=function(){}},d.timeout)),f.send(d.data),!0},a.jsonp=function(a){var b=document.createElement("script");b.type="text/javascript",b.src=a,document.body.appendChild(b)},a.make_qs=function(b){var c=[];for(var d in b)void 0!=b[d]&&c.push(a.str_replace(" ","+",d+"="+encodeURIComponent(b[d])));return c.join("&")},a.urlParam=function(a){var b=new RegExp("[?&]"+a+"=([^&#]*)").exec(window.location.href);return null==b?null:b[1]||0},a.str_replace=function(b,c,d){return d=d.replace(b,c),d.indexOf(b)>-1?a.str_replace(b,c,d):d},a.getKeys=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b},a.trimLeft=function(a){if("string"==typeof a)for(;a.length>0&&" "==a[0];)a=a.substring(1);return a},a.trimRight=function(a){if("string"==typeof a)for(;a.length>0&&" "==a[a.length-1];)a=a.substring(0,[a.length-1]);return a},a.trim=function(b){return b=a.trimLeft(b),b=a.trimRight(b)},a.windowScroll=function(a,b){if(!(0>b)){var c=10,d=0,e=a,f=e/(b/c),g=function(a,b){if(!(d>=a)){var e=d;d+=b,window.scrollTo(0,d),d!=e&&setTimeout(function(){g(a,b)},c)}};g(a,f)}},a.animation_queue_counter=0,a.animation_running=!1,a.animate_dequeue=function(b){a.animation_queue_counter--,0==a.animation_queue_counter&&(b.animate_callback(),a.animation_running=!1)},a.WindowOnload=function(a){if("complete"==document.readyState)return a.call(),!1;var b=function(b){b.addEventListener?b.addEventListener("load",a,!1):b.attachEvent("onload",a)};b(window)},a.readyList=[],a.isReady=!1,a._readyWait=1,a.readyAdd=function(b){a.isReady?b.call():(this.readyList.push(b),a.ready())},a.ready=function(){if("complete"===document.readyState)setTimeout(_ready);else if(document.addEventListener)document.addEventListener("DOMContentLoaded",DOMContentLoaded,!1),window.addEventListener("load",_ready,!1);else{document.attachEvent("onreadystatechange",DOMContentLoaded),window.attachEvent("onload",_ready);var b=!1;try{b=null==window.frameElement&&document.documentElement}catch(c){}b&&b.doScroll&&!function d(){if(!a.isReady){try{b.doScroll("left")}catch(c){return setTimeout(d,50)}_ready()}}()}},_ready=function(b){if(!a.isReady){if(b===!0?--a._readyWait:a.isReady)return;if(!document.body)return setTimeout(_ready);if(a.isReady=!0,b!==!0&&--a._readyWait>0)return;for(func in a.readyList)a.readyList.hasOwnProperty(func)&&a.readyList[func].call();a.readyList=[]}},DOMContentLoaded=function(){document.addEventListener?(document.removeEventListener("DOMContentLoaded",DOMContentLoaded,!1),_ready()):"complete"===document.readyState&&(document.detachEvent("onreadystatechange",DOMContentLoaded),_ready())},a}();var Netotiate=Netotiate||{};!function(a,b,c){function d(a){return a}function e(a){return decodeURIComponent(a.replace(f," "))}var f=/\+/g,g=a.cookie=function(f,h,i){if(h!==c){if(i=a.extend({},g.defaults,i),null===h&&(i.expires=-1),"number"==typeof i.expires){var j=i.expires,k=i.expires=new Date;k.setDate(k.getDate()+j)}return h=g.json?JSON.stringify(h):String(h),b.cookie=[encodeURIComponent(f),"=",g.raw?h:encodeURIComponent(h),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}for(var l=g.raw?d:e,m=b.cookie.split("; "),n=0,o=m.length;o>n;n++){var p=m[n].split("=");if(l(p.shift())===f){var q=l(p.join("="));return g.json?JSON.parse(q):q}}return null};g.defaults={},a.removeCookie=function(b,c){return null!==a.cookie(b)?(a.cookie(b,null,c),!0):!1}}("function"==typeof jQuery?jQuery:Netotiate.nq,document,void 0);var StorageFactory=function(){var a={};return a.create=function(a,b){function c(){return{db:{}}}function d(){try{return JSON.parse(b.getItem(a))}catch(c){return null}}function e(){try{b.setItem(a,JSON.stringify(f))}catch(c){}}var f={},g={};return g.db=function(a){function b(){return f.db[a]}function c(){var a={};return a.headers={},a.headers["expiration-dates"]={},a.body={},a}var d={};return d.parentKeys=function(){return Object.keys(f.db)},d.removeAffiliate=function(a){delete f.db[a],e()},d.key=function(b){function c(a){return a&&(new Date).getTime()-a>0}var d={};return d.getValue=function(){return c(f.db[a].headers["expiration-dates"][b])?(delete f.db[a].body[b],null):f.db[a].body[b]},d.setValue=function(c){return f.db[a].body[b]=c,e(),d},d.setExpTimestamp=function(c){return f.db[a].headers["expiration-dates"][b]=c,e(),d},d.getExpTimestamp=function(){return f.db[a].headers["expiration-dates"][b]},d.setTtl=function(c){return f.db[a].headers["expiration-dates"][b]=(new Date).getTime()+1e3*c*60*60,e(),d},d.remove=function(){d.setTtl(-1),e()},d},f.db[a]=b()||c(),d},f=d()||c(),g},a}(),CookieStorageFactory=function(){function a(a,b,c,d,e){var f=new Date;f.setTime(f.getTime()+60*e*60*1e3);var g="expires="+f.toUTCString(),h=a+"="+b+";domain="+c+";path="+d;"undefined"!=typeof e&&(h+=";"+g),document.cookie=h}function b(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1);if(-1!=e.indexOf(b))return e.substring(b.length,e.length)}return null}function c(){var c={};return c.getItem=function(a){return decodeURIComponent(b(a))},c.removeItem=function(b){return a(b,"",d.cookieDomain,"/",-1),c},c}var d={},e={};return e.createSessionCookieStorage=function(){var b=c();return b.setItem=function(c,e){return a(c,encodeURIComponent(e),d.cookieDomain,"/"),b},b},e.createLifetimeCookieStorage=function(){var b=c();return b.setItem=function(c,e){return a(c,encodeURIComponent(e),d.cookieDomain,"/",87600),b},b},d.pluginDomain="//plugin.personali.com",d.cookieDomain=d.pluginDomain.substring(d.pluginDomain.indexOf(".")),e}(),Netotiate=Netotiate||{};Netotiate.Storage={},Netotiate.StorageUtils={};var $=Netotiate.nq||$;Netotiate.StorageUtils.daydiff=function(a,b){return Math.ceil((b-a)/864e5)},Netotiate.StorageUtils.getExpireDateFromDays=function(a){try{return new Date((new Date).setTime((new Date).getTime()+24*a*60*60*1e3)).toUTCString()}catch(b){return null}},Netotiate.StorageUtils.Pair=function(a,b){this.key=a,this.value=b,this.toString=function(){return this.key+":"+encodeURIComponent(this.value)}},Netotiate.StorageUtils.extractPairs=function(a){var b=[],c=a.split(",");return $.each(c,function(a,c){var d=c.split(":");b.push(new Netotiate.StorageUtils.Pair(d[0],decodeURIComponent(d[1])))}),b},Netotiate.Storage=function(a,b,c){this.name=a,this.ttl=b,this.expires,this.affiliateId=c,this.value="",this.valuesArray=[],this.remove=function(){var a=$.cookie(this.name);a&&a.indexOf("affiliateId:"+this.affiliateId)>-1&&$.removeCookie(this.name)},this.update=function(){this.save()},this.getExpires=function(){return this.expires},this.save=function(){var a=this.expires?this.expires:Netotiate.StorageUtils.getExpireDateFromDays(this.ttl);a=new Date(a),this.affiliateId&&this.setValue("affiliateId",this.affiliateId),this.setValue("expires",a.toUTCString()),this.setValue("ttl",this.ttl);var b=[];$.each(this.valuesArray,function(a,c){var d=cookiePair=c;b.push(d.toString())}),b.length&&(this.value=b.join(","));864e5*this.ttl;$.cookie(this.name,this.value,{expires:new Date((new Date).setTime((new Date).getTime()+24*this.ttl*60*60*1e3)),path:"/",domain:this.getParentDomain()})},this.getParentDomain=function(){var a=location.hostname;try{var b=location.hostname.split("."),c=(b.shift(),b.join("."));a=c}catch(d){a=location.hostname}return a},this.getValue=function(a){var b=null;return $.each(this.valuesArray,function(c,d){d.key===a&&(b=d.value)}),b},this.setValue=function(a,b){var c=new Netotiate.StorageUtils.Pair(a,b);this.getValue(a)?$.each(this.valuesArray,function(c,d){d.key===a&&(d.value=b)}):this.valuesArray.push(c)},this.setName=function(a){this.name=a},this.getName=function(){return this.name},this.getTimeToLiveInDays=function(){return this.ttl},this.setExpireDate=function(a){return this.ttl=a},this.getAffiliateId=function(){return this.affiliateId},cookieVal=$.cookie(this.name),cookieVal&&(cookieVal.indexOf("affiliateId")>-1?cookieVal.indexOf("affiliateId:"+this.affiliateId)>-1&&(this.valuesArray=$.extend(this.valuesArray,Netotiate.StorageUtils.extractPairs(cookieVal)),this.affiliateId=this.getValue("affiliateId"),this.expires=this.getValue("expires"),this.ttl=this.getValue("ttl")):(this.valuesArray=$.extend(this.valuesArray,Netotiate.StorageUtils.extractPairs(cookieVal)),this.expires=this.getValue("expires"),this.ttl=this.getValue("ttl")))};var PersonalCounters=function(){var a={},b={},c=StorageFactory.create("nuspc",CookieStorageFactory.createSessionCookieStorage()),d=StorageFactory.create("nultpc",localStorage);return a.affiliate=function(a){function e(a,b){b=b||1,oldVal=a.getValue()||0,a.setValue(oldVal+b)}function f(a){var b=(new Date).getTime();return a.setValue(b),b}function g(a){return a.getValue()?((new Date).getTime()-a.getValue())/1e3:-1}var h=d.db(a),i=c.db(a),j=h.key("session_count"),k=h.key("page_impressions_total_count"),l=i.key("page_impressions_session_count"),m=h.key("page_impressions_total_time"),n=i.key("page_impressions_session_time"),o=h.key("netotiate_offers_total_count"),p=h.key("netotiate_purchases_total_count"),q=h.key("organic_purchases_total_count"),r=h.key("eligble_product_views_total"),s=i.key("eligble_product_views_session"),t=h.key("last_netotiate_order_timestamp"),u=h.key("last_organic_order_timestamp"),v=i.key("current_session_timestamp"),w=i.key("current_session_utc_start"),x=h.key("last_session_timestamp"),y=h.key("time_since_last_session"),z=h.key("daily_trigger_exit"),A={};return A.getCounterValue=function(a){return a.getValue()||0},A.getSessionCount=function(){return A.getCounterValue(j)},A.getSessionStart=function(){return A.getCounterValue(w)},A.getNetotiateOffersTotalCount=function(){return A.getCounterValue(o)},A.getNetotiatePurchasesTotalCount=function(){return A.getCounterValue(p)},A.getSessionDuration=function(){return g(v)},A.getEligibleProductViewsTotal=function(){return A.getCounterValue(r)},A.getEligibleProductViewsSession=function(){return A.getCounterValue(s)},A.getTimeSinceLastOrganicOrder=function(){return g(u)},A.getTimeSinceLastNetotiateOrder=function(){return g(t)},A.getOrganicPurchasesTotalCount=function(){return A.getCounterValue(q)},A.getAverageTimeOnPageEver=function(){var a=parseInt(A.getCounterValue(m)/A.getCounterValue(k));return isNaN(a)?0:a},A.getAverageTimeOnPageSession=function(){var a=parseInt(A.getCounterValue(n)/A.getCounterValue(l)),b=300;return isNaN(a)||a>b?0:a},A.getDailyTriggerExit=function(){return A.getCounterValue(z)},A.increaseNetotiateOffersTotalCount=function(a){return e(o,a),A},A.increaseNetotiatePurchasesTotalCount=function(a){return e(p,a),f(t),A},A.increaseOrganicPurchasesTotalCount=function(a){return e(q,a),f(u),A},A.increaseDailyTriggerExit=function(a){return e(z,a),z.setTtl(24),A},A.increasepPageImpressionsTotalCount=function(a){return e(k,a),A},A.increasepPageImpressionsSessionCount=function(a){return e(l,a),A},A.pageVisitStart=function(){b.currentVisitTimestamp=(new Date).getTime()},A.getProductSpentTime=function(){if(!b.currentVisitTimestamp)return-1;var a=(new Date).getTime();return parseInt((a-b.currentVisitTimestamp)/1e3)},A.pageVisitEnd=function(){var a=300,c=(new Date).getTime(),d=parseInt((c-b.currentVisitTimestamp)/1e3);d>a||0>d||(A.increasepPageImpressionsTotalCount(),e(m,d),A.increasepPageImpressionsSessionCount(),e(n,d))},A.startSession=function(){if(0==A.getSessionStart()||""==A.getSessionStart()){var a=(new Date).getTime();v.setValue(a);var b=x.getValue()?x.getValue():a;y.setValue((a-b)/1e3),x.setValue((new Date).getTime()),e(j,1),w.setValue((new Date).toUTCString())}return A},A.increaseEligibleProductViewsTotal=function(a){return e(r,a),A},A.increaseEligibleProductViewsSession=function(a){return e(s,a),A},A.getTimeSinceLastSession=function(){return y.getValue()||-1},A.asJSON=function(){return{session_count:A.getSessionCount(),session_start:A.getSessionStart(),session_duration:A.getSessionDuration(),time_since_last_session:A.getTimeSinceLastSession(),time_since_last_organic_purchase:A.getTimeSinceLastOrganicOrder(),time_since_last_netotiate_purchase:A.getTimeSinceLastNetotiateOrder(),eligible_product_views_total:A.getEligibleProductViewsTotal(),eligible_product_views_session:A.getEligibleProductViewsSession(),organic_purchases:A.getOrganicPurchasesTotalCount(),netotiate_offers:A.getNetotiateOffersTotalCount(),netotiate_purchases:A.getNetotiatePurchasesTotalCount(),daily_trigger_exit:A.getDailyTriggerExit(),avg_time_on_page_ever:A.getAverageTimeOnPageEver(),avg_time_on_page_session:A.getAverageTimeOnPageSession(),product_spent_time:A.getProductSpentTime()}},A},a}(),PersonalDB=function(){var a={},b={product_data:120,imp:120,distribution:120,user_facts:120,device_type:120,scope:120,cart_impressions:120,group_identifier:120,control_group:120,rule_revision_id:120};return a.cookie=StorageFactory.create("nudb_all",localStorage),a.affiliate=function(c){var d=this;return d.affiliateId=c,d.affiliate_key=a.cookie.db(c),d.imp=this.affiliate_key.key("imp"),d.cart_impressions=this.affiliate_key.key("cart_impressions"),d.product_data=this.affiliate_key.key("product_data"),d.distribution=this.affiliate_key.key("distribution"),d.user_facts=this.affiliate_key.key("user_facts"),d.device_type=this.affiliate_key.key("device_type"),d.group_identifier=this.affiliate_key.key("group_identifier"),d.control_group=this.affiliate_key.key("control_group"),d.rule_revision_id=this.affiliate_key.key("rule_revision_id"),d.scope=this.affiliate_key.key("scope"),this.setRuleRevisionId=function(a){a=a||"",d.rule_revision_id.setValue(a),d.rule_revision_id.setTtl(b.device_type)},this.getRuleRevisionId=function(){return d.rule_revision_id.getValue()||""},this.setGroupIdentifier=function(a){a=a||"",d.group_identifier.setValue(a),d.group_identifier.setTtl(b.group_identifier)},this.getGroupIdentifier=function(){return d.group_identifier.getValue()||""},this.setControlGroup=function(a){a=a||"",d.control_group.setValue(a),d.control_group.setTtl(b.control_group)},this.getControlGroup=function(){return d.control_group.getValue()||""},this.setDeviceType=function(a){a=a||"",d.device_type.setValue(a),d.device_type.setTtl(b.device_type)},this.getDeviceType=function(){return d.device_type.getValue()||""},this.setProductData=function(a){{var c=d.product_data.getValue()||{};d.device_type.getValue()||""}for(var e in a)c[e]=e in c?"nq"in Netotiate?Netotiate.nq.extend(c[e],a[e]):jQuery.extend(c[e],a[e]):a[e];d.product_data.setValue(c),d.product_data.setTtl(b.product_data),d.setImp(c)},this.getProductData=function(){return d.product_data.getValue()},this.setImp=function(){var a=new Array;product_data=d.product_data.getValue()||[];for(var c in product_data)a.push(c);d.imp.setValue(a),d.imp.setTtl(b.imp)},this.getImp=function(){return d.imp.getValue()},this.pushCartImpressions=function(a){if("cart"!=d.getScope())return"";var c=d.cart_impressions.getValue()||[],e=[];for(var f in a)f in a&&e.push(f+a[f].quantity);for(var g=e.sort().join(""),h=!1,i=0;i<c.length;i++)c[i]==g&&(h=!0);h||(c.push(g),d.cart_impressions.setValue(c),d.cart_impressions.setTtl(b.cart_impressions))},this.isCartPixelEligible=function(a){for(var b=d.cart_impressions.getValue()||[],c=[],e=0;e<a.length;e++)c.push(a[e].sku+a[e].quantity);for(var f=c.sort().join(""),e=0;e<b.length;e++)if(b[e]==f)return"true";return"false"},this.setScope=function(a){d.scope.setValue(a),d.scope.setTtl(b.scope)},this.getScope=function(){return d.scope.getValue()||""},this.setDistribution=function(a){d.distribution.setValue(a),d.distribution.setTtl(b.distribution)},this.getDistribution=function(){return d.distribution.getValue()||""},this.setUserFacts=function(a){d.user_facts.setValue(a),d.user_facts.setTtl(b.user_facts)},this.getUserFacts=function(){return d.user_facts.getValue()||""},this.getFieldBySku=function(a,b){var c=d.product_data.getValue()||{},a=this.locateSkuInProductData(a);return void 0!=c[a]&&void 0!=c[a][b]?c[a][b]:""},this.setFieldBySku=function(a,b,c){if(!this.isSkuExists(a))return!1;a=this.locateSkuInProductData(a);var e=d.product_data.getValue()||{};e[a][b]=c,d.setProductData(e)},this.isSkuExists=function(a){var b=d.product_data.getValue()||{};return a in b||a.toLowerCase()in b||a.toUpperCase()in b},this.locateSkuInProductData=function(a){var b=d.product_data.getValue()||{};return a in b?a:a.toLowerCase()in b?a.toLowerCase():a.toUpperCase()in b?a.toUpperCase():void 0},this.getFirstSku=function(){var a=d.product_data.getValue();for(var b in a)return b;return""},this.getReportingData=function(a){var b={};if(void 0==a)return b;if(this.isSkuExists(a)){var c=d.getFieldBySku(a,"flexes");for(var e in c)b[e]=c[e];b.manufacturer_name=d.getFieldBySku(a,"manufacturer_name"),b.initiator=d.getFieldBySku(a,"initiator")?d.getFieldBySku(a,"initiator"):"na",b.price=d.getFieldBySku(a,"price"),b.original_price=d.getFieldBySku(a,"original_price"),b.user_price=d.getFieldBySku(a,"user_price"),""!=d.getFieldBySku(a,"response_price")&&(b.response_price=d.getFieldBySku(a,"response_price")),""!=d.getFieldBySku(a,"temp_offer_id")&&(b.temp_offer_id=d.getFieldBySku(a,"temp_offer_id")),b.offer_id=d.getFieldBySku(a,"offer_id"),b.category=d.getFieldBySku(a,"category")}return b.distribution=d.getDistribution(),b.user_facts=d.getUserFacts(),b.group_identifier=d.getGroupIdentifier(),b.is_control_group=d.getControlGroup(),b.rule_revision_id=d.getRuleRevisionId(),b},d},a.constructFromData=function(b){var c=a.affiliate(b.affiliateId);"user_facts"in b&&c.setUserFacts(b.user_facts),c.setScope("scope"in b?b.scope:"plugin"),c.setProductData(b.product_data),c.setDistribution(b.distribution),c.setGroupIdentifier(b.group_identifier),c.setControlGroup(b.is_control_group),c.setRuleRevisionId(b.rule_revision_id),c.setDeviceType(b.device_type),"eligible"in b&&"true"==b.eligible&&c.pushCartImpressions(b.product_data)},a}(),PersonalCompactDB=function(){function a(a,b){for(i in b)if(b[i]==a)return!0;return!1}function b(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b}var c={},d={product_data:120,imp:120},e=3e3;return c.cookie=StorageFactory.create("nudb_all",CookieStorageFactory.createLifetimeCookieStorage()),c.affiliate=function(e){var f=this;return f.affiliateId=e,f.affiliate_key=c.cookie.db(e),f.imp=this.affiliate_key.key("imp"),
this.setProductData=function(d){for(var e=c.getRemainingSpace(),g=JSON.stringify(b(d)).length,h=f.getImp()||[],i=e-g;h.length>0&&0>i;){var j=h[0].length;h.splice(0,1),i+=j}0>i&&c.clearOtherAffiliates(f.affiliateId);for(var k in d)a(k,h)||h.push(k);f.setImp(h)},this.getProductData=function(){return f.product_data.getValue()},this.setImp=function(a){f.imp.setValue(a),f.imp.setTtl(d.imp)},this.getImp=function(){return f.imp.getValue()},this.isSkuExists=function(b){return imp=f.imp.getValue(),a(b,imp)},f},c.constructFromData=function(a){var b=c.affiliate(a.affiliateId);b.setProductData(a.product_data)},c.getCookieLength=function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1);if(0==e.indexOf(b))return e.substring(b.length,e.length).length}return 0},c.getRemainingSpace=function(){var a=c.getCookieLength("nudb_all");return e-a},c.clearOtherAffiliates=function(a){for(var b=c.cookie.db(a).parentKeys(),d=a+"",e=0;e<b.length;e++)b[e]!=d&&c.cookie.db(a).removeAffiliate(b[e])},c}(),norcDB=function(){var a={},b={data:120};return a.cookie=StorageFactory.create("norc",localStorage),a.affiliate=function(c){var d=this;return d.affiliateId=c,d.affiliate_key=a.cookie.db(c),d.data=this.affiliate_key.key("data"),this.getData=function(){return d.data.getValue()||{}},this.setData=function(a){var c=a.sku;"quantity"in a&&(c+="_"+a.quantity);var e=d.getData();e[c]=a,d.data.setValue(e),d.data.setTtl(b.data)},d},a}(),SampleGroup=function(){var a={},b=StorageFactory.create("netosg",localStorage);return a.affiliate=function(a){var c={},d=b.db(a).key("sample_group");return c.setTtl=function(a){d.setTtl(24*a)},c.setValue=function(a){return d.setValue(a),c.setCookieFallback(a),c},c.getValue=function(){return d.getValue()},c.contains=function(a){return c.getValue().indexOf(a)>-1},c.setCookieFallback=function(b){function c(){var a=location.hostname;try{var b=location.hostname.split("."),c=(b.shift(),b.join("."));a=c}catch(d){a=location.hostname}return a}var d=new Date((new Date).setTime((new Date).getTime()+10368e5));$.cookie("netosg","name:"+b+",affiliateId:"+a+",expires"+d.toUTCString()+",ttl:12",{domain:c(),expires:d,path:"/"})},c},a}(),NetotiateWindow=function(a){var b={};return b.construct=function(){return a.postMessage=a.postMessage||function(a,b,c){pm({target:a,type:b,data:c})},a.bind=a.bind||function(a,b){pm.bind(a,b)},a.createClient=function(b){var c={};c.server={};var d={};return d.events={},d.events.broadcast=function(b,d,e){a.postMessage(c.server,"netotiate_window_server.dispatch",{type:b,message:d}),a.postMessage(window,"netotiate_window.client.event.raised",{type:b,message:d}),a.bind(b+".result",function(a){"function"==typeof e&&e(a.message)})},d.events.subscribe=function(b,d){a.bind(b,function(e){var f=d(e.message);f&&a.postMessage(c.server,b+".window."+e.wid+".result",f)})},c.server=b||window.opener||window.parent,d},a},b.construct()}(NetotiateWindow||{}),Netotiate=Netotiate||{};Netotiate.Session={};var $=$||Netotiate.nq;Netotiate.Session.createSession=function(){var a="",b=function(a,b){return a=parseInt(a,10).toString(16),b<a.length?a.slice(a.length-b):b>a.length?Array(1+(b-a.length)).join("0")+a:a},c=Math.floor(123456789*Math.random())+1;a+="sid",a+=b(parseInt((new Date).getTime()/1e3,10),8),a+=b(c,5);var d="//plugin.personali.com",e=d.substring(d.indexOf("."));return document.cookie="nsid="+a+";path=/;domain="+e+";",Netotiate.Session.id=a,a},Netotiate.Session.getId=function(){var a=""!=Netotiate.Session.id?Netotiate.Session.id:Netotiate.Session.createSession();return a},Netotiate.Session.getValFromCookie=function(){for(var a="nsid=",b=document.cookie.split(";"),c=0;c<b.length;c++){for(var d=b[c];" "==d.charAt(0);)d=d.substring(1);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return""},Netotiate.Session.valFromCookie=Netotiate.Session.getValFromCookie(),""!=Netotiate.Session.valFromCookie?Netotiate.Session.id=Netotiate.Session.valFromCookie:Netotiate.Session.createSession();var __urlParam=function(a){var b=new RegExp("[?&]"+a+"=([^&#]*)").exec(window.location.href);return null==b?null:b[1]||0};try{PersonalCounters.affiliate(__urlParam("affiliateId")).startSession()}catch(e){}var Netotiate=Netotiate||{};Netotiate.Visitor={},Netotiate.Visitor.key="netotiate_ever",Netotiate.Visitor.vid="vid",Netotiate.Visitor.lifetimeTTLDays=1825,Netotiate.Visitor.uniqueId=function(a,b){"undefined"==typeof a&&(a="");var c,d=function(a,b){return a=parseInt(a,10).toString(16),b<a.length?a.slice(a.length-b):b>a.length?Array(1+(b-a.length)).join("0")+a:a};return this.php_js||(this.php_js={}),this.php_js.uniqidSeed||(this.php_js.uniqidSeed=Math.floor(123456789*Math.random())),this.php_js.uniqidSeed++,c=a,c+=d(parseInt((new Date).getTime()/1e3,10),8),c+=d(this.php_js.uniqidSeed,5),b&&(c+=(10*Math.random()).toFixed(8).toString()),c},Netotiate.Visitor.getId=function(){var a=new Netotiate.Storage(Netotiate.Visitor.key,Netotiate.Visitor.lifetimeTTLDays,null),b=a.getValue(Netotiate.Visitor.vid);return b||(b=Netotiate.Visitor.uniqueId(),a.setValue(Netotiate.Visitor.vid,b),a.save()),b},function(a,b,c){if(!("console"in a)){var d=a.console={};d.log=d.warn=d.error=d.debug=function(){}}b||(b={fn:{},extend:function(){for(var a=arguments[0],b=1,c=arguments.length;c>b;b++){var d=arguments[b];for(var e in d)a[e]=d[e]}return a}}),b.fn.pm=function(){return console.log("usage: \nto send:    $.pm(options)\nto receive: $.pm.bind(type, fn, [origin])"),this},b.pm=a.pm=function(a){e.send(a)},b.pm.bind=a.pm.bind=function(a,b,c,d){e.bind(a,b,c,d)},b.pm.unbind=a.pm.unbind=function(a,b){e.unbind(a,b)},b.pm.origin=a.pm.origin=null,b.pm.poll=a.pm.poll=200;var e={send:function(a){var d=b.extend({},e.defaults,a),f=d.target;if(d.target&&d.type){var g={data:d.data,type:d.type};d.success&&(g.callback=e._callback(d.success)),d.error&&(g.errback=e._callback(d.error)),"postMessage"in f&&void 0!=f.postMessage&&!d.hash?(e._bind(),f.postMessage(c.stringify(g),d.origin||"*")):(e.hash._bind(),e.hash.send(d,g))}},bind:function(c,d,f,g){"postMessage"in a&&!g?e._bind():e.hash._bind();var h=e.data("listeners.postmessage");h||(h={},e.data("listeners.postmessage",h));var i=h[c];i||(i=[],h[c]=i),i.push({fn:d,origin:f||b.pm.origin})},unbind:function(a,b){var c=e.data("listeners.postmessage");if(c)if(a)if(b){var d=c[a];if(d){for(var f=[],g=0,h=d.length;h>g;g++){var i=d[g];i.fn!==b&&f.push(i)}c[a]=f}}else delete c[a];else c={}},data:function(a,b){return void 0===b?e._data[a]:(e._data[a]=b,b)},_data:{},_CHARS:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),_random:function(){for(var a=[],b=0;32>b;b++)a[b]=e._CHARS[0|32*Math.random()];return a.join("")},_callback:function(a){var b=e.data("callbacks.postmessage");b||(b={},e.data("callbacks.postmessage",b));var c=e._random();return b[c]=a,c},_bind:function(){e.data("listening.postmessage")||(a.addEventListener?a.addEventListener("message",e._dispatch,!1):a.attachEvent&&a.attachEvent("onmessage",e._dispatch),e.data("listening.postmessage",1))},_dispatch:function(a){try{var b=c.parse(a.data)}catch(d){return}if(b.type){var f=e.data("callbacks.postmessage")||{},g=f[b.type];if(g)g(b.data);else for(var h=e.data("listeners.postmessage")||{},i=h[b.type]||[],j=0,k=i.length;k>j;j++){var l=i[j];if(l.origin&&a.origin!==l.origin){if(b.errback){var m={message:"postmessage origin mismatch",origin:[a.origin,l.origin]};e.send({target:a.source,data:m,type:b.errback})}}else try{var n=l.fn(b.data);b.callback&&e.send({target:a.source,data:n,type:b.callback})}catch(d){b.errback&&e.send({target:a.source,data:d,type:b.errback})}}}}};e.hash={send:function(b,d){var f=b.target,g=b.url;if(g){g=e.hash._url(g);var h,i=e.hash._url(a.location.href);if(a==f.parent)h="parent";else try{for(var j=0,k=parent.frames.length;k>j;j++){var l=parent.frames[j];if(l==a){h=j;break}}}catch(m){h=a.name}if(null!=h){var n={"x-requested-with":"postmessage",source:{name:h,url:i},postmessage:d},o="#x-postmessage-id="+e._random();f.location=g+o+encodeURIComponent(c.stringify(n))}}},_regex:/^\#x\-postmessage\-id\=(\w{32})/,_regex_len:"#x-postmessage-id=".length+32,_bind:function(){e.data("polling.postmessage")||(setInterval(function(){var b=""+a.location.hash,c=e.hash._regex.exec(b);if(c){var d=c[1];e.hash._last!==d&&(e.hash._last=d,e.hash._dispatch(b.substring(e.hash._regex_len)))}},b.pm.poll||200),e.data("polling.postmessage",1))},_dispatch:function(b){if(b){try{if(b=c.parse(decodeURIComponent(b)),!("postmessage"===b["x-requested-with"]&&b.source&&null!=b.source.name&&b.source.url&&b.postmessage))return}catch(d){return}var f=b.postmessage,g=e.data("callbacks.postmessage")||{},h=g[f.type];if(h)h(f.data);else{var i;i="parent"===b.source.name?a.parent:a.frames[b.source.name];for(var j=e.data("listeners.postmessage")||{},k=j[f.type]||[],l=0,m=k.length;m>l;l++){var n=k[l];if(n.origin){var o=/https?\:\/\/[^\/]*/.exec(b.source.url)[0];if(o!==n.origin){if(f.errback){var p={message:"postmessage origin mismatch",origin:[o,n.origin]};e.send({target:i,data:p,type:f.errback,hash:!0,url:b.source.url})}continue}}try{var q=n.fn(f.data);f.callback&&e.send({target:i,data:q,type:f.callback,hash:!0,url:b.source.url})}catch(d){f.errback&&e.send({target:i,data:d,type:f.errback,hash:!0,url:b.source.url})}}}}},_url:function(a){return(""+a).replace(/#.*$/,"")}},b.extend(e,{defaults:{target:null,url:null,type:null,data:null,success:null,error:null,origin:"*",hash:!1}})}(this,"undefined"==typeof jQuery?null:jQuery,function(a){var b={};return b.parse=a.parse,b.stringify=function(a){var c=typeof a;if("object"!=c||null===a)return"string"==c&&(a='"'+a.replace(/\"/g,'\\"')+'"'),String(a);var d,e,f=[],g=a&&a.constructor==Array;for(d in a)e=a[d],c=typeof e,"undefined"!=c&&a.hasOwnProperty(d)&&("string"==c?e='"'+e.replace(/\"/g,'\\"')+'"':"object"==c&&null!==e&&(e=b.stringify(e)),f.push((g?"":'"'+d+'":')+String(e)));return(g?"[":"{")+String(f)+(g?"]":"}")},b}(JSON));var Netotiate=Netotiate||{},_$="function"==typeof $?$:Netotiate.nq;Netotiate.Reporting=function(){var a={},b={};return a.baseUrl="//report.personali.com",a.ga={},a.ga.reportPageView=function(a){"undefined"!=typeof ga&&ga("send","pageview",{title:a})},a.ga.reporEvent=function(a){"undefined"!=typeof ga&&ga("send","event",a,"Action")},b.construct=function(){var b={};return b.reportEvent=function(c,d,e,f){b.put(c,d,e,f),a.ga.reporEvent(c),a.ga.reportPageView(c)},b.reportPageView=function(c,d,e,f){b.put(c,d,e,f),a.ga.reportPageView(c)},b.put=function(b,c,d,e){function f(){if(window.XDomainRequest){var b=new XDomainRequest;b.open("POST",a.baseUrl+"/reporting/put"),b.onload=function(){},b.onprogress=function(){},b.timeout=5e3,b.onerror=function(){},b.send(JSON.stringify(i))}}function g(){_$.ajax({url:a.baseUrl+"/reporting/put",type:"POST",cache:!1,data:JSON.stringify(i),dataType:"json",contentType:"application/json",crossDomain:!0,async:!1,success:function(){}})}function h(){try{var a=_$.support.cors;_$.support.cors=!0;var b=new XMLHttpRequest;return"withCredentials"in b?g():f(),_$.support.cors=a,!0}catch(c){return!1}}var i={};i.version="7.3.0-9",i.affiliate_id=c,i.event_type=b,i.visitor=Netotiate.Visitor.getId(),i.retailer_visitor=Netotiate.Reporting.retailer_visitorId||"",i.sid=Netotiate.Session.getId();var j=_$.cookie("nod")||"unknown-cookie";return i.device_type="unknown-cookie"!=j?j+"Web":j,i.referer=document.referrer,i=_$.extend(i,d),i.body=e||{},d.sample_group||(i.sample_group=SampleGroup.affiliate(c).getValue()||""),i.sg_source="sample_group"in d?"memory":"cookie",d.initiator&&PersonalDB.affiliate(c).setFieldBySku(d.sku,"initiator",d.initiator),i=_$.extend(i,PersonalDB.affiliate(c).getReportingData(d.sku)),i=_$.extend(i,PersonalCounters.affiliate(c).asJSON()),ga("set","dimension2",c+""),ga("set","dimension3",i.sample_group),ga("set","dimension4","eligible"in i?i.eligible:"True"),h()},b},b.construct()}(Netotiate.Reporting||{});var Netotiate=Netotiate||{};Netotiate.Hub=function(a){var b={},c={},d={};a.client=a.createClient();var e=function(a){var b=new RegExp("[?&]"+a+"=([^&#]*)").exec(window.location.href);return null==b?null:b[1]||0};return c.bindAllCounters=function(){a.client.events.subscribe("netotiate.plugin.page_exit",function(a){b.pageVisited||b.personaliInteraction||(PersonalCounters.affiliate(a.affiliateId).pageVisitEnd(),b.pageVisited=!0)}),a.client.events.subscribe("netotiate.plugin.impressions.collect",function(a){PersonalCounters.affiliate(a.affiliateId).increaseEligibleProductViewsTotal(a.impressions).increaseEligibleProductViewsSession(a.impressions)}),a.client.events.subscribe("netotiate.arena.offers.create",function(a){a&&PersonalCounters.affiliate(a.affiliateId).increaseNetotiateOffersTotalCount(1)}),a.client.events.subscribe("netotiate.plugin.impressions.view",function(a){b.personaliInteraction||(PersonalCounters.affiliate(a.affiliateId).pageVisitStart(),b.pageVisited=!1)}),a.client.events.subscribe("netotiate.plugin.trigger_on_exit.prompt",function(a){b.personaliInteraction||PersonalCounters.affiliate(a.affiliateId).pageVisitEnd(),b.pageVisited=!0})},c.bindGenericEvents=function(){a.client.events.subscribe("storage_get_value_callback",function(a){var b=new Netotiate.Storage(a.db,a.ttl,a.affiliateId),c=b.getValue(a.key);return{value:c,callback:a.callback}}),a.client.events.subscribe("storage_update",function(a){var b=new Netotiate.Storage(a.db,a.ttl,a.affiliateId);b.setValue(a.key,a.data),b.update()}),a.client.events.subscribe("Netotiate.Arena.AutoResponse.persist",function(a){return norcDB.affiliate(a.affiliateId).setData(a.response),norcDB.affiliate(a.affiliateId).getData()}),a.client.events.subscribe("Netotiate.Arena.AutoResponse.initData",function(a){return norcDB.affiliate(a.affiliateId).getData()}),Netotiate.Reporting.retailer_visitorId="",Netotiate.Reporting.retailer_visitorId_raw="unset value",a.client.events.subscribe("netotiate.plugin.visitor_id.store",function(a){Netotiate.Reporting.retailer_visitorId=a.vid}),a.client.events.subscribe("netotiate.plugin.store_sg",function(a){SampleGroup.affiliate(a.affiliateId).setValue(a.gn).setTtl(a.ttl)}),a.client.events.subscribe("netotiate.plugin.impressions.store",function(a){PersonalDB.constructFromData(a),PersonalCompactDB.constructFromData(a)}),a.client.events.subscribe("netotiate.plugin.connect.start",function(){a.client.events.broadcast("netotiate.hub.data.collected",{personalCounters:PersonalCounters.affiliate(e("affiliateId")).asJSON()})})},c.bindAllReportEvents=function(){a.client.events.subscribe("netotiate.plugin.page_exit",function(a){Netotiate.Reporting.reportEvent("ExitPage",a.affiliateId,{sku:""})}),a.client.events.subscribe("netotiate.plugin.retailer_visitor.domain_found",function(a){Netotiate.Reporting.reportEvent("UserGetHighestDomain",a.affiliateId,{},{domain:a.domain,attempts:a.attempts})}),a.client.events.subscribe("general.event.report",function(a){Netotiate.Reporting.reportEvent(a.eventType,a.affiliateId,{sku:a.sku,category:a.cid,additional_data:a.additional_data||""})}),a.client.events.subscribe("netotiate.arena.coupon.click",function(a){return Netotiate.Reporting.reportEvent("CouponClick",a.affiliateId,{sku:a.sku,category:a.cid},{is_copy_enabled:a.isCopyEnabled}),!0}),a.client.events.subscribe("netotiate.arena.coupon.view",function(a){Netotiate.Reporting.reportEvent("CouponView",a.affiliateId,{sku:a.sku,category:a.cid})}),a.client.events.subscribe("netotiate.plugin.button.view",function(a){Netotiate.Reporting.reportEvent("ButtonView",a.affiliateId,{category:a.cid,distribution:a.distribution,sku:a.sku,seen:a.seen||""})}),a.client.events.subscribe("netotiate.plugin.button.click",function(a){b.personaliInteraction=!0,Netotiate.Reporting.reportEvent("ButtonClick",a.affiliateId,{sku:a.sku,category:a.cid,initiator:a.initiator})}),a.client.events.subscribe("netotiate.plugin.widget.click",function(a){Netotiate.Reporting.reportEvent("WidgetClick",a.affiliateId,{sku:a.sku,category:a.cid},{ab_value:a.side})}),a.client.events.subscribe("netotiate.plugin.widget.view",function(a){Netotiate.Reporting.reportEvent("WidgetView",a.affiliateId,{sku:a.sku,category:a.cid},{ab_value:a.side})}),a.client.events.subscribe("netotiate.plugin.impressions.view",function(a){Netotiate.Reporting.reportEvent("Impression"+a.impression,a.affiliateId,{sku:a.sku,manufacturer_name:a.manufacturer_name,category:a.cid,eligible:a.eligibility,distribution:a.distribution,sample_group:a.sample_group,price:a.price,original_price:a.originalPrice})}),a.client.events.subscribe("netotiate.arena.make_an_offer.view",function(a){Netotiate.Reporting.reportPageView("MakeAnOfferView",a.affiliateId,{sku:a.sku,category:a.cid,initiator:a.initiator})}),a.client.events.subscribe("netotiate.arena.make_an_offer.close",function(a){return Netotiate.Reporting.reportEvent("MakeAnOfferClose",a.affiliateId,{sku:a.sku,category:a.cid}),!0}),a.client.events.subscribe("netotiate.arena.response.view",function(a){Netotiate.Reporting.reportPageView("ResponseView",a.affiliateId,{sku:a.sku,category:a.cid,temp_offer_id:a.tempOfferId,response_price:a.responsePrice},{offer_response:a.type,response_form:a.form}),PersonalDB.affiliate(a.affiliateId).setFieldBySku(a.sku,"response_price",a.responsePrice),PersonalDB.affiliate(a.affiliateId).setFieldBySku(a.sku,"temp_offer_id",a.tempOfferId)}),a.client.events.subscribe("netotiate.arena.response.close",function(a){return Netotiate.Reporting.reportEvent("ResponseClose",a.affiliateId,{sku:a.sku,category:a.cid},{offer_response:a.type,response_form:a.form,ab_value:a.ab_value}),!0}),a.client.events.subscribe("netotiate.arena.response.click",function(a){Netotiate.Reporting.reportEvent("ResponseClick",a.affiliateId,{sku:a.sku,category:a.cid},{offer_response:a.type,response_form:a.form})}),a.client.events.subscribe("netotiate.arena.make_an_offer.click",function(a){PersonalDB.affiliate(a.affiliateId).setFieldBySku(a.sku,"user_price",a.userPrice),Netotiate.Reporting.reportEvent("MakeAnOfferClick",a.affiliateId,{sku:a.sku,category:a.cid},{ab_value:a.inputMethod,offer_attempts:a.offerAttempts})}),a.client.events.subscribe("netotiate.arena.make_an_offer.error",function(a){Netotiate.Reporting.reportEvent("MakeAnOfferError",a.affiliateId,{sku:a.sku,category:a.cid},{ab_value:a.inputMethod,offer_attempts:a.offerAttempts})}),a.client.events.subscribe("netotiate.arena.registration.click",function(a){PersonalDB.affiliate(a.affiliateId).setFieldBySku(a.sku,"offer_id",a.offerId),Netotiate.Reporting.reportEvent("RegistrationClick",a.affiliateId,{sku:a.sku,category:a.cid})}),a.client.events.subscribe("netotiate.arena.checkout.init",function(a){Netotiate.Reporting.reportEvent("CheckoutInitiatedArenaView",a.affiliateId,{sku:a.sku,category:a.cid,additional_data:a.additional_data||""})}),a.client.events.subscribe("netotiate.plugin.trigger_on_exit.prompt",function(a){Netotiate.Reporting.reportEvent("TriggerOnExitPrompt",a.affiliateId,{sku:a.sku,category:a.cid,initiator:"onexit"}),PersonalCounters.affiliate(a.affiliateId).increaseDailyTriggerExit()}),a.client.events.subscribe("netotiate.plugin.auto_trigger.prompt",function(a){b.personaliInteraction=!0,Netotiate.Reporting.reportEvent("AutoTriggerPrompt",a.affiliateId,{sku:a.sku,category:a.cid,initiator:"auto_trigger"})}),a.client.events.subscribe("netotiate.arena.exit_prompt.click",function(a){Netotiate.Reporting.reportEvent("ExitPromptClick",a.affiliateId,{sample_group:a.sg,sku:a.sku,category:a.cid})}),a.client.events.subscribe("netotiate.arena.exit_prompt.view",function(a){PersonalCounters.affiliate(a.affiliateId).pageVisitEnd(),Netotiate.Reporting.reportPageView("ExitPromptView",a.affiliateId,{sku:a.sku,category:a.cid}),PersonalCounters.affiliate(a.affiliateId).increaseDailyTriggerExit()}),a.client.events.subscribe("netotiate.arena.exit_prompt.close",function(a){Netotiate.Reporting.reportEvent("ExitPromptClose",a.affiliateId,{sample_group:a.sg,sku:a.sku,category:a.cid})}),a.client.events.subscribe("netotiate.arena.offer_submit.error",function(a){Netotiate.Reporting.reportEvent("MakeAnOfferError",a.affiliateId,{sku:a.sku,category:a.cid},{error:a.error})}),a.client.events.subscribe("netotiate.arena.checkout.error",function(a){Netotiate.Reporting.reportEvent("CheckoutError",a.affiliateId,{sku:a.sku,category:a.cid},{error:a.error})}),a.client.events.subscribe("netotiate.arena.transaction_activate.error",function(a){Netotiate.Reporting.reportEvent("TransactionActivateError",a.affiliateId,{sku:a.sku,category:a.cid},{error:a.error})}),a.client.events.subscribe("netotiate.terms.api.error",function(a){Netotiate.Reporting.reportEvent("TermsApiError",a.affiliateId,{},{error:a.error})})},c.readyState=function(){a.client.events.broadcast("netotiate.hub.ready_state",null)},c.bindGenericEvents(),c.bindAllReportEvents(),c.bindAllCounters(),c.readyState(),d}(NetotiateWindow);